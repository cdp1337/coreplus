// plugin.js
tinymce.PluginManager.add("tabfocus",function(d){var e=tinymce.DOM,f=tinymce.each,c=tinymce.explode;function a(g){if(g.keyCode===9&&!g.ctrlKey&&!g.altKey&&!g.metaKey){g.preventDefault()}}function b(m){var g,k,h,j;if(m.keyCode!==9||m.ctrlKey||m.altKey||m.metaKey||m.isDefaultPrevented()){return}function n(p){k=e.select(":input:enabled,*[tabindex]:not(iframe)");function o(q){return q.nodeName==="BODY"||(q.type!="hidden"&&q.style.display!="none"&&q.style.visibility!="hidden"&&o(q.parentNode))}function i(q){return/INPUT|TEXTAREA|BUTTON/.test(q.tagName)&&tinymce.get(m.id)&&q.tabIndex!=-1&&o(q)}f(k,function(r,q){if(r.id==d.id){g=q;return false}});if(p>0){for(j=g+1;j<k.length;j++){if(i(k[j])){return k[j]}}}else{for(j=g-1;j>=0;j--){if(i(k[j])){return k[j]}}}return null}h=c(d.getParam("tab_focus",d.getParam("tabfocus_elements",":prev,:next")));if(h.length==1){h[1]=h[0];h[0]=":prev"}if(m.shiftKey){if(h[0]==":prev"){k=n(-1)}else{k=e.get(h[0])}}else{if(h[1]==":next"){k=n(1)}else{k=e.get(h[1])}}if(k){var l=tinymce.get(k.id||k.name);if(k.id&&l){l.focus()}else{window.setTimeout(function(){if(!tinymce.Env.webkit){window.focus()}k.focus()},10)}m.preventDefault()}}d.on("init",function(){if(d.inline){tinymce.DOM.setAttrib(d.getBody(),"tabIndex",null)}d.on("keyup",a);if(tinymce.Env.gecko){d.on("keypress keydown",b)}else{d.on("keydown",b)}})});